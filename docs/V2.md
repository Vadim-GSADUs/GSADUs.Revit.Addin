Codex V2 Summary:
Main Tab (Workflow Catalog Overview)
Intended actions & current wiring
WorkflowsList is supposed to display all saved workflows with sortable columns and double-click navigation to detail tabs.

Audit/Duplicate/Rename/Delete/Save & Close buttons are expected to trigger catalog operations (duplicate, rename, delete, audit, persist settings).

Saved workflow combos on other tabs feed this list for cross-tab hydration via SavedCombo_SelectionChanged.

Issues
Broken/Missing Bindings

ListView.ItemsSource is assigned through FindName inside RefreshMainList, leaving the tab without a declarative binding/observable collection and complicating MVVM testing.

Button click handlers remain in code-behind; there are no commands exposed from a parent view model, so the presenter cannot participate in catalog operations.

Inefficient/Redundant Code

Sorting, selection routing, and dialog prompts all happen in the window, duplicating logic that belongs in a presenter/service layer.

LOC Reduction Opportunities

A dedicated WorkflowManagerViewModel with observable summaries and ICommands would remove most FindName calls, the manual sort routine, and the SavedCombo_SelectionChanged branching logic.

Immediate actions (high leverage)
Introduce a parent view model that exposes ObservableCollection<WorkflowSummary> plus Duplicate, Rename, Delete, and Audit commands; bind WorkflowsList directly to it and remove RefreshMainList/manual sorting.

Replace SavedCombo_SelectionChanged hydration with presenter-driven state transitions so each tab view model reacts to a selected workflow without UI element lookups.

Move Save & Close logic into a SaveSettingsCommand exposed by the presenter, allowing the window to bind instead of handling the button click directly.

RVT Tab
Intended actions & current wiring
Saved workflow combo, Name box, Scope combo, Description box, Save button should load/persist RVT workflows through bindings to _presenter.RvtBase (a WorkflowTabBaseViewModel).

The Options group is expected to hold RVT-specific settings but is currently empty after Phase 2.

Issues
Broken/Missing Bindings

RvtSaveBtn starts disabled and relies on UpdateCanSaveFor to flip IsEnabled, bypassing WorkflowTabBaseViewModel.IsBaseSaveEnabled; this overwrites any binding and breaks MVVM flow.

NameBox_TextChanged/ScopeCombo_SelectionChanged mutate model state via FindName instead of relying on two-way bindings already declared in XAML.

Inefficient/Redundant Code

The empty Options group signals incomplete migration; there is no view model backing RVT-specific configuration, yet the plumbing remains in code-behind.

LOC Reduction Opportunities

Removing the name/scope text-changed handlers in favor of WorkflowTabBaseViewModel notifications would delete a large switch statement and the UpdateCanSaveFor helper.

Immediate actions
Bind Button.IsEnabled directly to IsBaseSaveEnabled (or a dedicated IsSaveEnabled property) and delete UpdateCanSaveFor/MarkDirty branches for RVT.

Remove NameBox_TextChanged/ScopeCombo_SelectionChanged for RVT; rely on two-way bindings to _presenter.RvtBase for state updates.

Reintroduce RVT options via a dedicated RvtWorkflowTabViewModel (even if minimal) and eliminate the placeholder grid entirely once bindings exist.

PDF Tab
Intended actions & current wiring
Saved combo, Name, Scope, description bind to _presenter.PdfWorkflow / WorkflowTabBaseViewModel for shared fields.

View set & export setup combos should list Revit resources via PdfWorkflowTabViewModel.AvailableViewSets/AvailableExportSetups and update SelectedSetName/SelectedPrintSet.

Save workflow button should enable when the view model validates all inputs (IsSaveEnabled).

Issues
Broken/Missing Bindings

UpdatePdfEnableState writes directly to PdfSaveBtn.IsEnabled, overriding the IsSaveEnabled binding and preventing the view model from controlling eligibility.

PdfNameBox_TextChanged/PdfConfigChanged duplicate the binding pipeline and depend on FindName values, ignoring PdfWorkflowTabViewModel state transitions.

WorkflowManagerWindow_Loaded repopulates combo ItemsSource and sets view model properties manually, mixing Revit document access with UI logic and bypassing the presenter.

Inefficient/Redundant Code

SaveWorkflow_Click re-reads TextBox/ComboBox values even though the PdfWorkflowTabViewModel already tracks them, leading to double validation code paths.

Calling WorkflowManagerWindow_Loaded from SavedCombo_SelectionChanged re-runs startup hydration logic for every selection change.

LOC Reduction Opportunities

Moving Revit data collection (view sets/export setups) into the presenter and filling AvailableViewSets/AvailableExportSetups directly would drop all FindName/FilteredElementCollector code from the window.

Immediate actions
Remove UpdatePdfEnableState/PdfNameBox_TextChanged and rely on PdfWorkflowTabViewModel.IsSaveEnabled; ensure the presenter populates the view model so bindings stay authoritative.

Shift Revit document queries for view sets/export setups into WorkflowManagerPresenter.OnLoaded, filling AvailableViewSets/AvailableExportSetups without touching UI controls.

Convert SaveWorkflow_Click into a presenter command that consumes the PDF tab view model’s properties, eliminating direct FindName calls and JSON assembly from the window.

Image Tab
Intended actions & current wiring
Saved combo, name/scope/description share the base view model; export range, print set, single view, resolution/crop/file settings bind to ImageWorkflowTabViewModel.

Save button should honor ImageWorkflowTabViewModel.IsSaveEnabled and show the preview from the view model.

Issues
Broken/Missing Bindings

PopulateImageSingleViewList and HydrateImageWorkflow clear/add ComboBoxItems directly, which detaches the ItemsSource binding to AvailableSingleViews/SelectedSingleViewId; the view model’s collection is never used.

ComputeImageSaveEligibility reads raw control values and forces ImageSaveBtn.IsEnabled, overriding the binding to IsSaveEnabled and duplicating validation already implemented in the view model.

Preview text is recomputed in both the view model and UpdateImagePreview, causing inconsistent results and more FindName lookups.

Inefficient/Redundant Code

_hydratingImage guards and repeated FindName updates exist solely because the view model is bypassed; once bindings work, these paths disappear.

PersistImageParameters re-sanitizes values already normalized in the view model (prefix/suffix/pattern/format).

LOC Reduction Opportunities

Once bindings are honored, ComputeImageSaveEligibility, UpdateImageSaveState, UpdateImagePreview, and many _presenter.OnMarkDirty handlers can be deleted in favor of property change notifications from ImageWorkflowTabViewModel.

Immediate actions
Populate AvailablePrintSets and AvailableSingleViews collections in the presenter, bind ItemsSource to them, and remove all manual ComboBox.Items manipulation so SelectedSingleViewId works again.

Delete ComputeImageSaveEligibility/UpdateImageSaveState in favor of the view model’s IsSaveEnabled; ensure bindings remain TwoWay so validation happens centrally.

Remove UpdateImagePreview and let the XAML bind directly to Preview, leveraging the existing RecomputePreview logic in the view model.

Convert Image tab persistence into a presenter command that consumes view model state, allowing PersistImageParameters to shrink dramatically or disappear.

CSV Tab
Intended actions & current wiring
Saved combo, name, scope, description, save button mirror RVT behavior and should rely solely on WorkflowTabBaseViewModel.

Issues
Broken/Missing Bindings

CsvSaveBtn remains disabled until UpdateCanSaveFor runs; this duplicates base view model logic and breaks binding expectations just like RVT.

NameBox_TextChanged, ScopeCombo_SelectionChanged, and DescBox_TextChanged mutate UI controls and the backing workflow simultaneously, creating desynchronization risk.

Inefficient/Redundant Code

CSV persistence is handled in the massive SaveWorkflow_Click switch, even though the tab needs only shared fields and a single action ID.

LOC Reduction Opportunities

Implementing a lightweight CsvWorkflowTabViewModel (or just using WorkflowTabBaseViewModel with commands) would remove all CSV-specific FindName and conditional branches from the window.

Immediate actions
Bind CsvSaveBtn.IsEnabled to IsBaseSaveEnabled and drop CSV branches from UpdateCanSaveFor/SaveWorkflow_Click.

Remove CSV-specific text/selection event handlers; rely on two-way bindings to the base view model for name, scope, and description updates.

Push CSV save logic into the presenter with a dedicated command, ensuring the window no longer builds workflow definitions directly.

Cross-cutting Recommendations (Next 3–5 Copilot-sized steps)
Rebind Save buttons to view-model properties/commands and delete UpdateCanSaveFor/UpdatePdfEnableState/UpdateImageSaveState. This single change restores MVVM intent and removes a large chunk of duplicated eligibility code.

Populate tab view models inside WorkflowManagerPresenter.OnLoaded/OnSavedComboChanged and stop touching controls through FindName. This centralizes hydration, fixes broken bindings (especially Image single-view selections), and clarifies responsibilities.

Split the monolithic SaveWorkflow_Click into per-output presenter commands consuming the respective tab view model data. Doing so eliminates the multi-hundred-line switch and repeated JSON assembly logic in the window.

Restore Image tab data flow by binding AvailablePrintSets/AvailableSingleViews and letting ImageWorkflowTabViewModel drive preview + validation. This fixes the currently broken single-view selection, drops _hydratingImage, and halves the Image-tab code-behind size.

docs/WorkflowManagerPhase2FunctionalAudit.md
diff --git a/docs/WorkflowManagerPhase2FunctionalAudit.md b/docs/WorkflowManagerPhase2FunctionalAudit.md
new file mode 100644
index 0000000000000000000000000000000000000000..f258d5a78b2ac25ab3bfea2c06f8708600a07079
--- /dev/null
+++ b/docs/WorkflowManagerPhase2FunctionalAudit.md
@@ -0,0 +1,137 @@
+# Workflow Manager Window Functional Audit (Phase 2 MVVM)
+
+This review walks each major surface of `WorkflowManagerWindow` after the Phase 2 refactor. For every key UI affordance we map the intended action, describe how it is currently wired into code-behind/view models, and call out broken bindings, redundant logic, and places where lines of code (LOC) can be retired in favor of straightforward XAML bindings.
+
+## Main tab – workflow list, audit, and global actions
+
+### Intended actions
+* `WorkflowsList` should reflect the persisted workflow catalog, allow sorting, and drill into the correct tab on double-click.
+* Toolbar buttons (Audit/Duplicate/Rename/Delete/Save & Close/Cancel) should work without window-level `FindName` calls and should round-trip through the presenter/catalog.
+
+### Current implementation snapshot
+* The list view is still populated by `RefreshMainList()` in the window code-behind, not by a bound collection. The method walks `_catalog` and pushes anonymous rows into `WorkflowsList.ItemsSource` imperatively.【F:src/GSADUs.Revit.Addin/UI/WorkflowManagerWindow.xaml†L34-L52】【F:src/GSADUs.Revit.Addin/UI/WorkflowManagerWindow.xaml.cs†L486-L505】
+* Sorting and double-click navigation are handled entirely in code-behind via `GridViewColumnHeader_Click` and `WorkflowsList_MouseDoubleClick` using reflection over anonymous item types.【F:src/GSADUs.Revit.Addin/UI/WorkflowManagerWindow.xaml†L34-L52】【F:src/GSADUs.Revit.Addin/UI/WorkflowManagerWindow.xaml.cs†L505-L713】
+* Audit/Duplicate/Rename/Delete all reach into `_catalog` directly and repeat modal dialog boilerplate per button.【F:src/GSADUs.Revit.Addin/UI/WorkflowManagerWindow.xaml.cs†L544-L620】
+
+### Broken or missing bindings
+* No list binding exists for `WorkflowsList`; consequently the presenter cannot observe selection or updates, and MVVM telemetry hooks never fire.【F:src/GSADUs.Revit.Addin/UI/WorkflowManagerWindow.xaml.cs†L486-L505】
+* Button clicks are still routed through legacy event handlers instead of commands, so none of the actions are testable or reusable in a ViewModel/Presenter layer.【F:src/GSADUs.Revit.Addin/UI/WorkflowManagerWindow.xaml†L45-L51】
+
+### Redundancy / LOC reduction opportunities
+* `RefreshMainList`, `RefreshSavedCombos`, and the manual `FindName` sorting logic duplicate functionality a `CollectionViewSource` + observable collection would give “for free.”【F:src/GSADUs.Revit.Addin/UI/WorkflowManagerWindow.xaml.cs†L486-L570】
+* Each toolbar handler repeats catalog lookups and confirmation logic that should live in a single presenter method or command implementation.【F:src/GSADUs.Revit.Addin/UI/WorkflowManagerWindow.xaml.cs†L544-L620】
+
+### High-impact next steps
+1. Bind `WorkflowsList.ItemsSource` to an observable collection exposed by a new `WorkflowManagerWindowViewModel`; drop `RefreshMainList` and `FindName` usage for selection.【F:src/GSADUs.Revit.Addin/UI/WorkflowManagerWindow.xaml†L34-L52】【F:src/GSADUs.Revit.Addin/UI/WorkflowManagerWindow.xaml.cs†L486-L520】
+2. Replace the toolbar click handlers with ICommand bindings surfaced by the presenter (e.g., `RenameWorkflowCommand`) so catalog mutations live outside the view.【F:src/GSADUs.Revit.Addin/UI/WorkflowManagerWindow.xaml†L45-L51】【F:src/GSADUs.Revit.Addin/UI/WorkflowManagerWindow.xaml.cs†L544-L592】
+3. Push sort state into the view model (`CollectionViewSource.SortDescriptions`) and delete `GridViewColumnHeader_Click` plus `_lastHeader/_lastDirection` tracking.【F:src/GSADUs.Revit.Addin/UI/WorkflowManagerWindow.xaml.cs†L512-L533】
+4. Expose the active selection through the view model and have the presenter coordinate tab navigation, eliminating the reflection-heavy `WorkflowsList_MouseDoubleClick` routine.【F:src/GSADUs.Revit.Addin/UI/WorkflowManagerWindow.xaml.cs†L687-L713】
+
+## RVT tab – basic workflow metadata and legacy options
+
+### Intended actions
+* Saved workflow picker should hydrate the `Rvt` workflow definition, and edits to Name/Scope/Description should immediately surface through the shared base view model.
+* The “Options” group should eventually contain RVT-specific toggles (currently empty).
+* Save button should enable when required fields are valid.
+
+### Current implementation snapshot
+* DataContext is assigned manually in the constructor via `FindName("RvtTabRoot")`, so the tab is not designable and the binding graph is brittle.【F:src/GSADUs.Revit.Addin/UI/WorkflowManagerWindow.xaml.cs†L206-L215】
+* Name/Scope/Description text boxes bind to `WorkflowTabBaseViewModel`, yet the code-behind still listens for `TextChanged` and `SelectionChanged` events to drive dirty-state and `_catalog` updates.【F:src/GSADUs.Revit.Addin/UI/WorkflowManagerWindow.xaml†L73-L103】【F:src/GSADUs.Revit.Addin/UI/WorkflowManagerWindow.xaml.cs†L437-L470】
+* `RvtSaveBtn` starts disabled in XAML and relies on `UpdateCanSaveFor` manually toggling `IsEnabled`, overriding any potential binding to `IsBaseSaveEnabled`.【F:src/GSADUs.Revit.Addin/UI/WorkflowManagerWindow.xaml†L101-L103】【F:src/GSADUs.Revit.Addin/UI/WorkflowManagerWindow.xaml.cs†L437-L453】
+
+### Broken or missing bindings
+* Because `UpdateCanSaveFor` sets `RvtSaveBtn.IsEnabled`, any binding to a future `IsSaveEnabled` property would be clobbered; we never leverage `WorkflowTabBaseViewModel.IsBaseSaveEnabled` for the RVT tab.【F:src/GSADUs.Revit.Addin/UI/ViewModels/WorkflowTabBaseViewModel.cs†L32-L46】【F:src/GSADUs.Revit.Addin/UI/WorkflowManagerWindow.xaml.cs†L437-L453】
+* The RVT “Options” group is empty after the refactor, so the window lost previously available toggles; users cannot configure RVT export specifics anymore.【F:src/GSADUs.Revit.Addin/UI/WorkflowManagerWindow.xaml†L83-L94】
+
+### Redundancy / LOC reduction opportunities
+* Manual dirty tracking (`_isDirtyRvt`, `SetSaveVisual`) duplicates functionality a `BooleanToVisibility/Opacity` binding could provide across all tabs.【F:src/GSADUs.Revit.Addin/UI/WorkflowManagerWindow.xaml.cs†L416-L454】
+* `SavedCombo_SelectionChanged` hydrates the VM **and** resets the text boxes via `FindName`, which is redundant once the binding is trusted.【F:src/GSADUs.Revit.Addin/UI/WorkflowManagerWindow.xaml.cs†L648-L684】
+
+### High-impact next steps
+1. Bind `RvtSaveBtn.IsEnabled` to `IsBaseSaveEnabled` (or a new `IsSaveEnabled`) and delete `UpdateCanSaveFor` branch logic plus `_isDirtyRvt` opacity management.【F:src/GSADUs.Revit.Addin/UI/WorkflowManagerWindow.xaml.cs†L416-L454】【F:src/GSADUs.Revit.Addin/UI/ViewModels/WorkflowTabBaseViewModel.cs†L32-L46】
+2. Move `SavedCombo_SelectionChanged` RVT hydration into the presenter/view model so the view no longer mirrors values manually.【F:src/GSADUs.Revit.Addin/UI/WorkflowManagerWindow.xaml.cs†L648-L684】
+3. Reintroduce RVT option controls as bound properties in a dedicated RVT view model instead of leaving the `GroupBox` empty (restores lost functionality while keeping bindings simple).【F:src/GSADUs.Revit.Addin/UI/WorkflowManagerWindow.xaml†L83-L94】
+4. Replace constructor `FindName` DataContext assignment with XAML-level `TabItem.DataContext` or `ContentTemplate`, removing four `try` blocks and improving testability.【F:src/GSADUs.Revit.Addin/UI/WorkflowManagerWindow.xaml.cs†L206-L215】
+
+## PDF tab – export setup
+
+### Intended actions
+* Users pick a view/sheet set, export setup, configure filename pattern, review output location, and save when requirements are satisfied.
+
+### Current implementation snapshot
+* The PDF tab binds to `PdfWorkflowTabViewModel`, and the constructor pushes available set/setup names into the view model collections (good direction).【F:src/GSADUs.Revit.Addin/UI/WorkflowManagerWindow.xaml†L117-L165】【F:src/GSADUs.Revit.Addin/UI/WorkflowManagerWindow.xaml.cs†L312-L335】
+* Despite the binding, the window still wires `TextChanged`/`SelectionChanged` handlers that re-run `UpdatePdfEnableState`, which sets `PdfSaveBtn.IsEnabled` directly.【F:src/GSADUs.Revit.Addin/UI/WorkflowManagerWindow.xaml.cs†L370-L400】
+* `PdfWorkflowTabViewModel` requires patterns to include `{SetName}` **and** end with `.pdf`, but `UpdatePdfEnableState` only checks for the placeholder, so the view and VM disagree on when saving is allowed.【F:src/GSADUs.Revit.Addin/UI/ViewModels/PdfWorkflowTabViewModel.cs†L13-L28】【F:src/GSADUs.Revit.Addin/UI/WorkflowManagerWindow.xaml.cs†L370-L383】
+* Saving reads back from the controls instead of the view model, sanitizes the pattern, and persists via `_catalog.SaveAndRefresh`, causing dual sources of truth for every field.【F:src/GSADUs.Revit.Addin/UI/WorkflowManagerWindow.xaml.cs†L1156-L1250】
+
+### Broken or missing bindings
+* `PdfSaveBtn` is declared with `IsEnabled="{Binding IsSaveEnabled}"`, but `UpdatePdfEnableState` assigns `IsEnabled` and `Opacity`, severing the binding; the VM’s `IsSaveEnabled` never drives the button state.【F:src/GSADUs.Revit.Addin/UI/WorkflowManagerWindow.xaml†L163-L165】【F:src/GSADUs.Revit.Addin/UI/WorkflowManagerWindow.xaml.cs†L370-L383】
+* Labels for output folder/overwrite policy are populated imperatively during `Loaded` rather than exposing read-only properties on the presenter, blocking design-time previews and tests.【F:src/GSADUs.Revit.Addin/UI/WorkflowManagerWindow.xaml†L147-L154】【F:src/GSADUs.Revit.Addin/UI/WorkflowManagerWindow.xaml.cs†L354-L358】
+
+### Redundancy / LOC reduction opportunities
+* `PdfSelectionChanged`, `PdfPatternChanged`, and `PdfConfigChanged` all repeat the same three-line dirty-state block; binding `Command`/`UpdateSourceTrigger=PropertyChanged` is already doing this work via `INotifyPropertyChanged` in the VM.【F:src/GSADUs.Revit.Addin/UI/WorkflowManagerWindow.xaml.cs†L388-L400】
+* Sanitizing the pattern in `SaveWorkflow_Click` duplicates logic that belongs inside `PdfWorkflowTabViewModel` (or a shared validator) so it can gate `IsSaveEnabled` consistently.【F:src/GSADUs.Revit.Addin/UI/WorkflowManagerWindow.xaml.cs†L1198-L1215】
+
+### High-impact next steps
+1. Remove `UpdatePdfEnableState` and bind button enablement/opacity to VM properties so `PdfWorkflowTabViewModel.IsSaveEnabled` becomes the single authority.【F:src/GSADUs.Revit.Addin/UI/ViewModels/PdfWorkflowTabViewModel.cs†L13-L28】【F:src/GSADUs.Revit.Addin/UI/WorkflowManagerWindow.xaml†L163-L165】
+2. Promote output folder/overwrite strings to presenter/view model properties and bind the labels, eliminating the `FindName` writes in `Loaded`.【F:src/GSADUs.Revit.Addin/UI/WorkflowManagerWindow.xaml†L147-L154】【F:src/GSADUs.Revit.Addin/UI/WorkflowManagerWindow.xaml.cs†L354-L358】
+3. Let the VM own pattern sanitization and `.pdf` enforcement so `SaveWorkflow_Click` can just read the VM state (or disappear entirely once saving moves to commands).【F:src/GSADUs.Revit.Addin/UI/ViewModels/PdfWorkflowTabViewModel.cs†L13-L28】【F:src/GSADUs.Revit.Addin/UI/WorkflowManagerWindow.xaml.cs†L1198-L1215】
+4. Replace the `PdfNameBox_TextChanged` handler with pure binding updates to `WorkflowTabBaseViewModel.Name`, enabling deletion of duplicated dirty-state logic.【F:src/GSADUs.Revit.Addin/UI/WorkflowManagerWindow.xaml†L117-L123】【F:src/GSADUs.Revit.Addin/UI/WorkflowManagerWindow.xaml.cs†L465-L470】
+
+## Image tab – export scope, format, and whitelist
+
+### Intended actions
+* Users choose whether to export a print set or a single view, configure quality/crop/prefix-suffix, preview the filename, manage whitelist categories, and save when requirements are met.
+
+### Current implementation snapshot
+* The tab binds to `ImageWorkflowTabViewModel`, but the window still hand-populates the combo boxes and radio buttons during `Loaded`, often by assigning `ItemsSource` directly on controls that already have `ItemsSource` bindings.【F:src/GSADUs.Revit.Addin/UI/WorkflowManagerWindow.xaml†L171-L283】【F:src/GSADUs.Revit.Addin/UI/WorkflowManagerWindow.xaml.cs†L279-L310】【F:src/GSADUs.Revit.Addin/UI/ViewModels/ImageWorkflowTabViewModel.cs†L18-L160】
+* `PopulateImageSingleViewList` clears and fills `ImageSingleViewCombo.Items` with `ComboBoxItem` instances instead of populating the bound `AvailableSingleViews`, so the binding never receives data and exceptions are swallowed.【F:src/GSADUs.Revit.Addin/UI/WorkflowManagerWindow.xaml.cs†L112-L169】【F:src/GSADUs.Revit.Addin/UI/ViewModels/ImageWorkflowTabViewModel.cs†L18-L52】
+* Save enablement is computed twice: `ImageWorkflowTabViewModel.IsSaveEnabled` and the code-behind `ComputeImageSaveEligibility()` / `UpdateImageSaveState()` which interrogate the UI controls and overwrite `ImageSaveBtn.IsEnabled` (breaking the binding just like the PDF tab).【F:src/GSADUs.Revit.Addin/UI/WorkflowManagerWindow.xaml†L281-L283】【F:src/GSADUs.Revit.Addin/UI/WorkflowManagerWindow.xaml.cs†L980-L1094】【F:src/GSADUs.Revit.Addin/UI/ViewModels/ImageWorkflowTabViewModel.cs†L113-L133】
+* Preview text is exposed via `ImageWorkflowTabViewModel.Preview`, yet `UpdateImagePreview()` rebuilds the string from control values and writes straight to the text block, bypassing the binding.【F:src/GSADUs.Revit.Addin/UI/WorkflowManagerWindow.xaml†L243-L265】【F:src/GSADUs.Revit.Addin/UI/ViewModels/ImageWorkflowTabViewModel.cs†L83-L152】【F:src/GSADUs.Revit.Addin/UI/WorkflowManagerWindow.xaml.cs†L1098-L1154】
+
+### Broken or missing bindings
+* Binding to `ImageWorkflowTabViewModel.AvailablePrintSets` is ignored because the code assigns `ImagePrintSetCombo.ItemsSource` to a raw list, so the VM never sees the user’s choice; saving then re-reads control text, not VM state.【F:src/GSADUs.Revit.Addin/UI/WorkflowManagerWindow.xaml.cs†L279-L310】【F:src/GSADUs.Revit.Addin/UI/ViewModels/ImageWorkflowTabViewModel.cs†L18-L44】
+* Radio buttons rely on the `EqualityToBooleanConverter`, but code-behind resets selections and marks dirty by poking controls rather than trusting the bound `ExportScope`, leading to inconsistencies when `_hydratingImage` suppresses events.【F:src/GSADUs.Revit.Addin/UI/WorkflowManagerWindow.xaml†L188-L217】【F:src/GSADUs.Revit.Addin/UI/WorkflowManagerWindow.xaml.cs†L148-L188】
+
+### Redundancy / LOC reduction opportunities
+* `ComputeImageSaveEligibility`, `UpdateImageSaveState`, `UpdateImagePreview`, and a dozen `*_TextChanged` handlers duplicate the VM’s `Recompute` logic; removing them would eliminate ~150 LOC and consolidate validation in one place.【F:src/GSADUs.Revit.Addin/UI/WorkflowManagerWindow.xaml.cs†L980-L1154】【F:src/GSADUs.Revit.Addin/UI/ViewModels/ImageWorkflowTabViewModel.cs†L83-L152】
+* The blacklist summary and picker still use `_settings` in the view instead of a presenter service, making it hard to unit test and causing direct persistence from the UI layer.【F:src/GSADUs.Revit.Addin/UI/WorkflowManagerWindow.xaml†L268-L274】【F:src/GSADUs.Revit.Addin/UI/WorkflowManagerWindow.xaml.cs†L223-L257】
+
+### High-impact next steps
+1. Populate `AvailablePrintSets`, `AvailableSingleViews`, and whitelist summaries from the presenter/VM (e.g., expose methods on `ImageWorkflowTabViewModel`) and delete `PopulateImageSingleViewList`/manual `ItemsSource` wiring.【F:src/GSADUs.Revit.Addin/UI/WorkflowManagerWindow.xaml.cs†L112-L310】【F:src/GSADUs.Revit.Addin/UI/ViewModels/ImageWorkflowTabViewModel.cs†L18-L52】
+2. Remove `ComputeImageSaveEligibility`/`UpdateImageSaveState` and bind `ImageSaveBtn.IsEnabled`/`ToolTip` to VM properties, letting `Recompute` drive the UI.【F:src/GSADUs.Revit.Addin/UI/ViewModels/ImageWorkflowTabViewModel.cs†L98-L133】【F:src/GSADUs.Revit.Addin/UI/WorkflowManagerWindow.xaml.cs†L980-L1098】
+3. Let `Preview` stay owned by the VM and delete `UpdateImagePreview`; TextChanged handlers should simply update the bound properties (or be removed entirely).【F:src/GSADUs.Revit.Addin/UI/ViewModels/ImageWorkflowTabViewModel.cs†L83-L152】【F:src/GSADUs.Revit.Addin/UI/WorkflowManagerWindow.xaml.cs†L1098-L1154】
+4. Move blacklist storage/persistence to the presenter so the view stops mutating `_settings` directly and the logic can be reused (e.g., by future dialogs).【F:src/GSADUs.Revit.Addin/UI/WorkflowManagerWindow.xaml.cs†L223-L257】
+
+## CSV tab – basic metadata
+
+### Intended actions
+* CSV workflows should mirror the RVT tab experience: pick a saved workflow, edit Name/Scope/Description, and save when valid.
+
+### Current implementation snapshot
+* Shares the same base bindings as the RVT tab, but `CsvSaveBtn` is hard-coded disabled and only toggled by `UpdateCanSaveFor` (no dedicated view model state).【F:src/GSADUs.Revit.Addin/UI/WorkflowManagerWindow.xaml†L288-L320】【F:src/GSADUs.Revit.Addin/UI/WorkflowManagerWindow.xaml.cs†L437-L453】
+* Saving again flows through the monolithic `SaveWorkflow_Click`, mixing CSV logic with PDF/Image specifics and relying on `FindName` to fetch control values.【F:src/GSADUs.Revit.Addin/UI/WorkflowManagerWindow.xaml.cs†L1156-L1250】
+
+### Broken or missing bindings
+* Binding `CsvSaveBtn` to `WorkflowTabBaseViewModel.IsBaseSaveEnabled` would remove the need for manual enablement, but the current implementation overwrites `IsEnabled` so MVVM state is ignored.【F:src/GSADUs.Revit.Addin/UI/ViewModels/WorkflowTabBaseViewModel.cs†L32-L46】【F:src/GSADUs.Revit.Addin/UI/WorkflowManagerWindow.xaml.cs†L437-L453】
+
+### Redundancy / LOC reduction opportunities
+* `SaveWorkflow_Click` contains CSV conditionals solely to add the `export-csv` action ID; moving CSV persistence into the presenter would make the shared handler unnecessary.【F:src/GSADUs.Revit.Addin/UI/WorkflowManagerWindow.xaml.cs†L1196-L1233】
+
+### High-impact next steps
+1. Bind CSV inputs and save state directly to `WorkflowTabBaseViewModel`, drop the manual `UpdateCanSaveFor` branch, and ensure dirty tracking lives in the presenter.【F:src/GSADUs.Revit.Addin/UI/WorkflowManagerWindow.xaml.cs†L416-L454】
+2. Split CSV persistence into a dedicated method/command so the shared `SaveWorkflow_Click` can be removed entirely once PDF/Image move to MVVM commands.【F:src/GSADUs.Revit.Addin/UI/WorkflowManagerWindow.xaml.cs†L1156-L1250】
+3. Surface CSV-specific validation (if any) via the base view model rather than re-parsing controls at save time.【F:src/GSADUs.Revit.Addin/UI/ViewModels/WorkflowTabBaseViewModel.cs†L13-L46】
+
+## Cross-cutting issues
+
+* Presenter lifecycle hooks (`OnWindowConstructed`, `OnLoaded`, `OnSavedComboChanged`) are placeholders, so the window shoulders almost all orchestration, defeating the purpose of the MVVM migration.【F:src/GSADUs.Revit.Addin/UI/Presenters/WorkflowManagerPresenter.cs†L11-L51】
+* `WorkflowManagerWindow` constructor still calls `FindName` four times to assign DataContexts, a pattern repeated across tabs that can be replaced by declarative XAML to reduce fragility and LOC.【F:src/GSADUs.Revit.Addin/UI/WorkflowManagerWindow.xaml.cs†L206-L215】
+* The monolithic `SaveWorkflow_Click` mixes concerns across every workflow type and uses `_catalog` directly; migrating to per-tab commands would let us delete hundreds of lines while keeping the flow “stupid simple.”【F:src/GSADUs.Revit.Addin/UI/WorkflowManagerWindow.xaml.cs†L1156-L1250】
+
+### Presenter-friendly, high-impact refactoring prompts
+1. “Bind each tab root to the presenter-provided view model in XAML and remove the constructor `FindName` DataContext assignments.”【F:src/GSADUs.Revit.Addin/UI/WorkflowManagerWindow.xaml.cs†L206-L215】
+2. “Refactor `SaveWorkflow_Click` into per-tab ICommand implementations so the window no longer reads controls via `FindName`.”【F:src/GSADUs.Revit.Addin/UI/WorkflowManagerWindow.xaml.cs†L1156-L1250】
+3. “Let `PdfWorkflowTabViewModel` and `ImageWorkflowTabViewModel` own save enablement entirely; delete `UpdatePdfEnableState`, `ComputeImageSaveEligibility`, and related handlers.”【F:src/GSADUs.Revit.Addin/UI/WorkflowManagerWindow.xaml.cs†L370-L409】【F:src/GSADUs.Revit.Addin/UI/WorkflowManagerWindow.xaml.cs†L980-L1100】
+4. “Populate Image tab combo boxes via the view model collections instead of imperatively adding `ComboBoxItem`s.”【F:src/GSADUs.Revit.Addin/UI/WorkflowManagerWindow.xaml.cs†L112-L310】【F:src/GSADUs.Revit.Addin/UI/ViewModels/ImageWorkflowTabViewModel.cs†L18-L52】
+5. “Move workflow list population and sorting to a bound observable collection handled by the presenter.”【F:src/GSADUs.Revit.Addin/UI/WorkflowManagerWindow.xaml.cs†L486-L533】


docs/WorkflowManagerPhase2Reanalysis.md
diff --git a/docs/WorkflowManagerPhase2Reanalysis.md b/docs/WorkflowManagerPhase2Reanalysis.md
new file mode 100644
index 0000000000000000000000000000000000000000..33037407c2f33a6306d82bbca6efcb681fdd6c11
--- /dev/null
+++ b/docs/WorkflowManagerPhase2Reanalysis.md
@@ -0,0 +1,28 @@
+# Workflow Manager Phase 2 Reanalysis
+
+## 1. Current hotspots blocking LOC reduction
+- **WorkflowManagerWindow.xaml.cs remains 1,271 LOC** and still hosts most workflow hydration, validation, and persistence logic, indicating we have not yet realized the 60-70% shrinkage target from the Phase 2 guide.【F:src/GSADUs.Revit.Addin/UI/WorkflowManagerWindow.xaml.cs†L200-L368】【f6f57b†L1-L2】
+- The `Loaded` handler rehydrates PDF and Image tabs by hand (sheet set collectors, event wiring, label updates) instead of delegating to presenter/VM layers, keeping tight coupling with Revit APIs and WPF controls.【F:src/GSADUs.Revit.Addin/UI/WorkflowManagerWindow.xaml.cs†L259-L368】
+- PDF enablement, dirty tracking, and save-state rendering are still computed via `FindName` lookups (`UpdatePdfEnableState`, `UpdateCanSaveFor`, `SetSaveVisual`), duplicating logic that already exists in `PdfWorkflowTabViewModel`.【F:src/GSADUs.Revit.Addin/UI/WorkflowManagerWindow.xaml.cs†L370-L477】【F:src/GSADUs.Revit.Addin/UI/ViewModels/PdfWorkflowTabViewModel.cs†L6-L29】
+- Image tab persistence and validation still live in the window (`PersistImageParameters`, `ComputeImageSaveEligibility`, `UpdateImageSaveState`, preview updates), even though the Image tab view model now exposes equivalent state and guards.【F:src/GSADUs.Revit.Addin/UI/WorkflowManagerWindow.xaml.cs†L996-L1096】【F:src/GSADUs.Revit.Addin/UI/ViewModels/ImageWorkflowTabViewModel.cs†L22-L152】
+- `SaveWorkflow_Click` directly reads WPF controls, manipulates action IDs, and performs JsonElement plumbing; this is the largest remaining “god method” in the file and prevents presenter/service layers from owning persistence orchestration.【F:src/GSADUs.Revit.Addin/UI/WorkflowManagerWindow.xaml.cs†L1156-L1232】
+
+## 2. Deviations from the Phase 2 workflow plan
+- The Phase 2 guide calls for the presenter to set tab DataContexts and eventually own hydration, yet `WorkflowManagerPresenter` is still a stub and the window performs all wiring, so we have not shifted responsibilities per section C1/C2 of the guide.【F:src/GSADUs.Revit.Addin/UI/Presenters/WorkflowManagerPresenter.cs†L8-L41】【F:docs/WorkflowManagerPhase2Analysis.md†L69-L131】
+- Shared base bindings were introduced, but the window still falls back to direct control reads before saving, contradicting the plan to “read from the tab VM first, then fall back temporarily” – the fallback has become the primary path.【F:src/GSADUs.Revit.Addin/UI/WorkflowManagerWindow.xaml.cs†L1162-L1178】【F:docs/WorkflowManagerPhase2Analysis.md†L111-L118】
+- We continue to wire dozens of code-behind event handlers in XAML (e.g., `GridViewColumnHeader_Click`, `NameBox_TextChanged`, image scope toggles) instead of moving toward bindings/commands as outlined in Step C2.4 (“Replace FindName lookups”).【F:src/GSADUs.Revit.Addin/UI/WorkflowManagerWindow.xaml†L34-L200】【F:docs/WorkflowManagerPhase2Analysis.md†L139-L146】
+- Image workflow preview and enablement are calculated twice (view model vs. window), which raises drift risk and violates the KISS principle by keeping redundant logic alive.【F:src/GSADUs.Revit.Addin/UI/WorkflowManagerWindow.xaml.cs†L1045-L1151】【F:src/GSADUs.Revit.Addin/UI/ViewModels/ImageWorkflowTabViewModel.cs†L98-L152】
+
+## 3. Refactoring opportunities aligned with "stupid simple"
+- **Promote view models to single source of truth.** Route PDF/Image control bindings exclusively through their tab view models; delete `UpdatePdfEnableState`, `UpdateImageSaveState`, and related event handlers once bindings drive the buttons directly.【F:src/GSADUs.Revit.Addin/UI/WorkflowManagerWindow.xaml.cs†L370-L477】【F:src/GSADUs.Revit.Addin/UI/WorkflowManagerWindow.xaml.cs†L1045-L1096】
+- **Move Revit API hydration into the presenter.** Expose `PopulatePdfSourcesAsync`/`PopulateImageSourcesAsync` on `WorkflowManagerPresenter` so `WorkflowManagerWindow_Loaded` collapses to a couple of delegate calls and no longer touches collectors or combo wiring.【F:src/GSADUs.Revit.Addin/UI/WorkflowManagerWindow.xaml.cs†L259-L336】【F:src/GSADUs.Revit.Addin/UI/Presenters/WorkflowManagerPresenter.cs†L8-L41】
+- **Extract persistence helpers.** Lift the JSON parameter assembly in `SaveWorkflow_Click` into `WorkflowCatalogService` (e.g., `UpdatePdfWorkflow`, `UpdateImageWorkflow`) to hide serialization noise and leave the window responsible only for invoking service methods.【F:src/GSADUs.Revit.Addin/UI/WorkflowManagerWindow.xaml.cs†L1156-L1232】【F:src/GSADUs.Revit.Addin/Services/WorkflowCatalogService.cs†L17-L83】
+- **Centralize dirty state.** Track dirty flags inside view models (expose `IsDirty`), allowing `SetSaveVisual`/`MarkDirty`/`UpdateCanSaveFor` to disappear and letting XAML triggers handle button visuals.【F:src/GSADUs.Revit.Addin/UI/WorkflowManagerWindow.xaml.cs†L416-L477】【F:src/GSADUs.Revit.Addin/UI/ViewModels/PdfWorkflowTabViewModel.cs†L6-L29】
+- **Replace `FindName` sweeps with strongly typed fields or bindings.** Caching control references or binding them removes repeated lookup boilerplate and aligns with Step C2.4 from the guide.【F:src/GSADUs.Revit.Addin/UI/WorkflowManagerWindow.xaml.cs†L370-L1154】
+
+## 4. Next 3-5 small, high-leverage Copilot prompts
+1. **"Update WorkflowManagerPresenter to populate PDF sheet sets and export setups, and expose a method the window can call instead of in-line collectors."** This keeps the change local and shaves ~60 LOC from the `Loaded` handler.【F:src/GSADUs.Revit.Addin/UI/WorkflowManagerWindow.xaml.cs†L259-L336】
+2. **"Bind PdfSaveBtn.IsEnabled and opacity directly to PdfWorkflowTabViewModel.IsSaveEnabled, then delete UpdatePdfEnableState/PdfConfigChanged."** Eliminates duplicated enablement logic and unlocks ~40 LOC reduction.【F:src/GSADUs.Revit.Addin/UI/WorkflowManagerWindow.xaml.cs†L370-L477】【F:src/GSADUs.Revit.Addin/UI/ViewModels/PdfWorkflowTabViewModel.cs†L6-L29】
+3. **"Move Image preview + eligibility calculations into ImageWorkflowTabViewModel (expose Preview, Tooltip text), remove UpdateImageSaveState/ComputeImageSaveEligibility."** Consolidates validations and cuts another ~70 LOC.【F:src/GSADUs.Revit.Addin/UI/WorkflowManagerWindow.xaml.cs†L1045-L1151】【F:src/GSADUs.Revit.Addin/UI/ViewModels/ImageWorkflowTabViewModel.cs†L22-L152】
+4. **"Split SaveWorkflow_Click into WorkflowCatalogService methods per output type and call them from the window."** Reduces JSON plumbing in the UI layer and clarifies persistence responsibilities.【F:src/GSADUs.Revit.Addin/UI/WorkflowManagerWindow.xaml.cs†L1156-L1232】【F:src/GSADUs.Revit.Addin/Services/WorkflowCatalogService.cs†L43-L83】
+5. **"Convert the saved-workflow ComboBox handlers to bind SelectedWorkflowId on each tab view model, replacing SavedCombo_SelectionChanged."** Removes reflection-based lookups and sets up presenter-driven navigation.【F:src/GSADUs.Revit.Addin/UI/WorkflowManagerWindow.xaml.cs†L498-L564】【F:src/GSADUs.Revit.Addin/UI/ViewModels/WorkflowTabBaseViewModel.cs†L8-L37】